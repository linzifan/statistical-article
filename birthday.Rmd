---
title: "Birthday Problem"
author: "Zifan Lin"
date: "March 2, 2015"
output: html_document
---
### Introduction

The **birthday problem** or **birthday paradox** concerns the probability that in a set of $n$ randomly chosen people, some pair of them will have the same birthday. Obviously, if there are 367 people, at least two of them will have the same birthday (since there are 366 possible birthdays, and according to [pigeonhole principle](http://en.wikipedia.org/wiki/Pigeonhole_principle)). It means that the probability we concerns reaches to $100%$ if there are 367 people. Surprisingly, only 70 people are needed to reach $99.9%$ probability, and 23 people for $50%$ probability. In this article, I will mathematically calculate the probability and simulate it with `R`.

### Calculate the probability

For simplicity, we will ignore leap year (i.e. excluding Feb.29), and assume that 365 possible birthdays are equally likely.

Suppose there are $n$ people ($1< n < 366$), the probability of at least two people have the same birthday = 1 - the probability of everyone among these $n$ people has different birthdays.

To calculate the probability that everyone has diffrent birthdays:
$$\bar{P}(n) = 1 \times \frac{364}{365} \times \frac{363}{365} \times \dots \times \frac{365-n+1}{365} =  \frac{365!}{365^n (365-n)!}$$

Therefore, the probality of interest:
$$P(n) = 1 - \bar{P}(n)$$

```{r, warning=FALSE}
n <- 1:365
prob <- 1 - factorial(n) * choose(365, n) / 365^n

plot(n, prob, type = "l", lwd = 2, col = "blue")

# check two results
abline(h = 0.5, lty = 2)
abline(v = 23, lty = 2, col = "red")
abline(h = 1, lty = 2)
abline(v = 70, lty = 2, col = "red")
axis(1, c(23,70))
```

Here we see that the plot stops at around $n=120$ because both $n!$ and $365^n$ are bigger than the computation range of `R`. However, from the formula, we can conclude the probability is a decreasing function of $n$. The probability is very close to 1 when $n=70$, and the probability reaches to $50%$ when $n=23$.


### Simulate the probability

```{r, warning=FALSE}
issame <- rep(0, 365)
for (n in 1:365){
  # simulate 1000 times
  for (j in 1:1000){
    # each time randomly assign birthdays to these n people
    birthday <- sample(1:365, n, replace = TRUE)
    # check whether there is at least one pair of same birthday
    if (length(unique(birthday)) < n) issame[n] <- issame[n] + 1
  }
}
plot(issame/1000, type="l", lwd = 2, col = "green", ylab="prob")
# Compare with mathematically calculation
n <- 1:365
prob <- 1 - factorial(n) * choose(365, n) / 365^n
lines(n, prob, type = "l", lwd = 2, col = "blue", lty = 2)
legend("bottomright", c("calculated", "simulated"), lty = c(2, 1),
       lwd = c(2, 2), col = c("blue", "green"))

```



