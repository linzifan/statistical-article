---
title: "Which Sequence is Fake?"
author: "Zifan Lin"
date: "April 6, 2015"
output: html_document
---
### Introduction
The two sequences shown below each purportedly represent the results of 200 tosses of a fair coin. One of these is an actual sequence obtained from coin tossing, while the other sequence is artificial. Can you decide, in sixty seconds or less, which of the sequences is more likely to have arisen from actual coin tossing and which one is the imposter?

```
Sequence # 1
THHHHTTTTHHHHTHHHHHHHHTTTHHTTHHHHHTTTTTTHHTHHTHHHT
TTHTTHHHHTHTTTHTTTHHTTTTHHHHHHTTTHHTTHHHTHHHHHTTTT
THTTTHHTTHTTHHTTTHHTTTHHTHHTHHTTTTTHHTHHHHHHTHTHTT
HTHTTHHHTTHHTHTHHHHHHHHTTHTTHHHTHHTTHTTTTTTHHHTHHH
```

```
Sequence # 2
THTHTTTHTTTTTHTHTTTHTTHHHTHHTHTHTHTTTTHHTTHHTTHHHT
HHHTTHHHTTTHHHTHHHHTTTHTHTHHHHTHTTTHHHTHHTHTTTHHTH
HHTHHHHTTHTHHTHHHTTTHTHHHTHHTTTHHHTTTTHHHTHTHHHHTH
TTHHTTTTHTHTHTTHTHHTTHTTTHTTTTHHHHTHTHHHTTHHHHHTHH
```

### Description

We will study the pattern of these two sequences.
Two variables need to be investigate: number of heads/tails (should be around 100 if fair coin), number of maximum length of consecutive heads/tails (follow a distribution).

```{r}
seq1 <- c('T', 'H', 'H', 'H', 'H', 'T', 'T', 'T', 'T', 'H', 'H', 'H', 'H', 'T', 'H', 'H', 'H', 'H', 'H', 'H',
          'H', 'H', 'T', 'T', 'T', 'H', 'H', 'T', 'T', 'H', 'H', 'H', 'H', 'H', 'T', 'T', 'T', 'T', 'T', 'T', 
          'H', 'H', 'T', 'H', 'H', 'T', 'H', 'H', 'H', 'T', 'T', 'T', 'H', 'T', 'T', 'H', 'H', 'H', 'H', 'T',
          'H', 'T', 'T', 'T', 'H', 'T', 'T', 'T', 'H', 'H', 'T', 'T', 'T', 'T', 'H', 'H', 'H', 'H', 'H', 'H', 
          'T', 'T', 'T', 'H', 'H', 'T', 'T', 'H', 'H', 'H', 'T', 'H', 'H', 'H', 'H', 'H', 'T', 'T', 'T', 'T', 
          'T', 'H', 'T', 'T', 'T', 'H', 'H', 'T', 'T', 'H', 'T', 'T', 'H', 'H', 'T', 'T', 'T', 'H', 'H', 'T', 
          'T', 'T', 'H', 'H', 'T', 'H', 'H', 'T', 'H', 'H', 'T', 'T', 'T', 'T', 'T', 'H', 'H', 'T', 'H', 'H', 
          'H', 'H', 'H', 'H', 'T', 'H', 'T', 'H', 'T', 'T', 'H', 'T', 'H', 'T', 'T', 'H', 'H', 'H', 'T', 'T',
          'H', 'H', 'T', 'H', 'T', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'T', 'T', 'H', 'T', 'T', 'H', 'H', 
          'H', 'T', 'H', 'H', 'T', 'T', 'H', 'T', 'T', 'T', 'T', 'T', 'T', 'H', 'H', 'H', 'T', 'H', 'H', 'H')
seq2 <- c('T', 'H', 'T', 'H', 'T', 'T', 'T', 'H', 'T', 'T', 'T', 'T', 'T', 'H', 'T', 'H', 'T', 'T', 'T', 'H', 
          'T', 'T', 'H', 'H', 'H', 'T', 'H', 'H', 'T', 'H', 'T', 'H', 'T', 'H', 'T', 'T', 'T', 'T', 'H', 'H', 
          'T', 'T', 'H', 'H', 'T', 'T', 'H', 'H', 'H', 'T', 'H', 'H', 'H', 'T', 'T', 'H', 'H', 'H', 'T', 'T',
          'T', 'H', 'H', 'H', 'T', 'H', 'H', 'H', 'H', 'T', 'T', 'T', 'H', 'T', 'H', 'T', 'H', 'H', 'H', 'H',
          'T', 'H', 'T', 'T', 'T', 'H', 'H', 'H', 'T', 'H', 'H', 'T', 'H', 'T', 'T', 'T', 'H', 'H', 'T', 'H',
          'H', 'H', 'T', 'H', 'H', 'H', 'H', 'T', 'T', 'H', 'T', 'H', 'H', 'T', 'H', 'H', 'H', 'T', 'T', 'T',
          'H', 'T', 'H', 'H', 'H', 'T', 'H', 'H', 'T', 'T', 'T', 'H', 'H', 'H', 'T', 'T', 'T', 'T', 'H', 'H', 
          'H', 'T', 'H', 'T', 'H', 'H', 'H', 'H', 'T', 'H', 'T', 'T', 'H', 'H', 'T', 'T', 'T', 'T', 'H', 'T', 
          'H', 'T', 'H', 'T', 'T', 'H', 'T', 'H', 'H', 'T', 'T', 'H', 'T', 'T', 'T', 'H', 'T', 'T', 'T', 'T', 
          'H', 'H', 'H', 'H', 'T', 'H', 'T', 'H', 'H', 'H', 'T', 'T', 'H', 'H', 'H', 'H', 'H', 'T', 'H', 'H')
cat("Sequence #1 ", "H:", sum(seq1 == 'H'), ",", "T:", sum(seq1 == "T"))
cat("Sequence #2 ", "H:", sum(seq2 == 'H'), ",", "T:", sum(seq2 == "T"))
getmaxlen <- function(seq, char){
  lennum <- rep(0, length(seq))
  s <- 1
  for (i in 1:length(lennum)){
    if (i != length(lennum)){
      if (seq[i] != seq[i + 1]){
      lennum[i] <- s
      s <- 1
      }
       else s <- s + 1
    }
    else lennum[i] <- s
  }
  return(max(lennum[which(seq == char)]))
}

cat("Sequence #1: ", "H sequence", getmaxlen(seq1, "H"), ",", "T sequence", getmaxlen(seq1, "T"))
cat("Sequence #2: ", "H sequence", getmaxlen(seq2, "H"), ",", "T sequence", getmaxlen(seq2, "T"))
```

### Simulation

Let's take a simulation to see the distribution of number of maximum length of consecutive heads/tails.

```{r}
nTrails <- 1000
nH <- rep(0, nTrails); nT <- rep(0, nTrails)
ncon <- rep(0, nTrails)
size <- 200
for (i in 1:nTrails){
  seq <- sample(c("H", "T"), size, replace = TRUE, prob = c(0.5, 0.5))
  nH[i] <- sum(seq == "H"); nT[i] <- sum(seq == "T")
  ncon[i] <- max(getmaxlen(seq, "H"), getmaxlen(seq, "T"))
}
cat("Mean of numbers of heads:", mean(nH), ",", "Mean of numbers of tails:", mean(nT))
cat("Mean of maximum length of consecutive heads/tails:", mean(ncon))
cat("Probability that maximum length of consecutive heads/tails is larger than 5:", mean(ncon > 5))
hist(ncon, main = "Distribution of maximum length of consecutive heads/tails")
```

Here we could conclude that Sequence # 2 is fake, since maximum length of consecutive heads/tails in Sequence # 2 is only 5.


### Python Approach
```{r test-python, eval=FALSE, engine='python'}
# coding: utf-8
seq1 = "THHHHTTTTHHHHTHHHHHHHHTTTHHTTHHHHHTTTTTTHHTHHTHHHTTTHTTHHHHTHTTTHTTTHHTTTTHHHHHHTTTHHTTHHHTHHHHHTTTTTHTTTHHTTHTTHHTTTHHTTTHHTHHTHHTTTTTHHTHHHHHHTHTHTTHTHTTHHHTTHHTHTHHHHHHHHTTHTTHHHTHHTTHTTTTTTHHHTHHH"
seq1 = list(seq1)
seq2 = "THTHTTTHTTTTTHTHTTTHTTHHHTHHTHTHTHTTTTHHTTHHTTHHHTHHHTTHHHTTTHHHTHHHHTTTHTHTHHHHTHTTTHHHTHHTHTTTHHTHHHTHHHHTTHTHHTHHHTTTHTHHHTHHTTTHHHTTTTHHHTHTHHHHTHTTHHTTTTHTHTHTTHTHHTTHTTTHTTTTHHHHTHTHHHTTHHHHHTHH"
seq2 = list(seq2)
def getlen(seq, char):
    res = 0
    for i in range(len(seq)):
        if seq[i] == char:
            res += 1
    return res
print "Sequence #1", "H:", getlen(seq1, "H"), "T:", getlen(seq1, "T")
print "Sequence #2", "H:", getlen(seq2, "H"), "T:", getlen(seq2, "T")
def getmaxlen(seq, char):
    if char == "T":
        split = "H"
    if char == "H":
        split = "T"
    temp = "".join([seq[i] for i in range(len(seq))])
    y = [len(item) for item in temp.split(split)]
    return max(y)
print "Sequence #1: ", "H sequence", getmaxlen(seq1, "H"), ",", "T sequence", getmaxlen(seq1, "T")
print "Sequence #2: ", "H sequence", getmaxlen(seq2, "H"), ",", "T sequence", getmaxlen(seq2, "T")
import random
def throwCoin():
    return random.choice(["H", "T"])
nTrails = 1000
size = 200
ncon = []
for i in range(nTrails):
    seq = [throwCoin() for i in range(size)]
    ncon.append(max(getmaxlen(seq, "H"), getmaxlen(seq, "T")))
print "Mean of maximum length of consecutive heads/tails:", float(sum(ncon)) / len(ncon)
print "Probability that maximum length of consecutive heads/tails is larger than 5:", float(sum([item >5 for item in ncon]))/ len(ncon)
```


```
    Sequence #1 H: 108 T: 92

    Sequence #2 H: 105 T: 95

    Sequence #1:  H sequence 8 , T sequence 6

    Sequence #2:  H sequence 5 , T sequence 5

    Mean of maximum length of consecutive heads/tails: 7.891
    Probability that maximum length of consecutive heads/tails is larger than 5: 0.966
```